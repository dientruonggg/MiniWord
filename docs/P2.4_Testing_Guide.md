# P2.4 Scrolling & Viewport Optimization - Testing Guide

## Quick Testing Instructions

To manually test the P2.4 implementation on Zorin OS (or any Linux system):

### 1. Build and Run
```bash
cd /home/runner/work/MiniWord/MiniWord
dotnet run --project src/MiniWord.UI/MiniWord.UI.csproj
```

### 2. Test Keyboard Navigation

#### Test Page Up/Down
1. Type or paste several paragraphs of text (enough to require scrolling)
2. Press **Page Down** - window should scroll down by one viewport height
3. Press **Page Up** - window should scroll back up by one viewport height
4. Repeat to verify smooth behavior

Expected Result: 
- Smooth scrolling animation
- Content scrolls by viewport height
- Cursor remains in text editor

#### Test Ctrl+Home
1. Scroll down to middle or bottom of document
2. Press **Ctrl+Home**
3. Window should immediately jump to the top of the document

Expected Result:
- Instant scroll to top (no animation needed for keyboard shortcuts)
- Viewport shows start of document

#### Test Ctrl+End
1. Start at top of document
2. Press **Ctrl+End**
3. Window should immediately jump to the bottom of the document

Expected Result:
- Instant scroll to bottom
- Viewport shows end of document

### 3. Test Multi-Page Scrolling

To test multi-page document handling:

```csharp
// Add this code to MainWindow constructor (after InitializeComponent)
var canvas = this.FindControl<Controls.A4Canvas>("A4Canvas");
var document = new A4Document(Log.ForContext<MainWindow>());

// Add multiple pages
document.AddPage("Page 1 content");
document.AddPage("Page 2 content");
document.AddPage("Page 3 content");

canvas.SetDocument(document);
```

Then test:
1. Verify canvas height increases to accommodate all pages
2. Use Page Down to scroll through pages
3. Pages should be visually separated by 20px spacing

### 4. Verify Integration with P2.3 Features

While testing scrolling, also verify P2.3 cursor/selection features still work:

1. **Text Selection with Mouse**: Click and drag to select text
2. **Copy/Paste**: 
   - Select text
   - Press Ctrl+C to copy
   - Move cursor
   - Press Ctrl+V to paste
3. **Text Selection with Keyboard**: Hold Shift + arrow keys

Expected Result:
- All P2.3 features work normally
- Scrolling doesn't interfere with selection
- Selection remains visible during scroll

### 5. Check Logging

Monitor the log file while testing:
```bash
tail -f /logs/miniword-runtime.txt
```

You should see log entries like:
- "Scrolling to page X at offset Y px"
- "Page Up pressed - Scrolling up"
- "Ctrl+Home pressed - Scrolling to top"
- "Scroll changed - Offset: ..."

## Known Expected Behaviors

1. **Smooth Scrolling**: Only applies to programmatic scrolls (e.g., ScrollToOffsetSmooth), not keyboard shortcuts
2. **Page Detection**: GetVisiblePageIndex() calculates based on scroll position
3. **Canvas Height**: Dynamically adjusts based on number of pages in document

## Troubleshooting

### Keyboard Shortcuts Not Working
- Ensure MainWindow has focus (click on the window)
- Check log file for "Key pressed" debug messages
- Verify no other component is capturing keyboard events

### Scrolling Not Smooth
- This is expected for keyboard shortcuts (immediate scroll)
- Smooth scrolling only applies to programmatic API calls

### Canvas Not Showing Multiple Pages
- Verify SetDocument() was called with a valid document
- Check that document has PageCount > 1
- Look for "Canvas height updated for X pages" in logs

## Performance Notes

For documents with many pages (100+):
- Current implementation renders all pages
- Phase 2.5 will add virtual rendering (only visible pages)
- Scrolling performance should remain good up to ~1000 pages

## Success Criteria

✅ All keyboard shortcuts respond correctly
✅ Scrolling is smooth and predictable  
✅ Multi-page documents display correctly
✅ P2.3 features (cursor/selection) still work
✅ Logs show appropriate messages
✅ No exceptions or errors during operation

## Next Steps

After verifying P2.4:
1. Consider implementing Phase 2.5 (virtual rendering for performance)
2. Or proceed to Phase 3 (MVVM implementation)
3. See ROADMAP.md for complete phase breakdown
